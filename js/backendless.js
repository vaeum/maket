!function(root){"use strict";function initXHR(){try{"undefined"==typeof XMLHttpRequest.prototype.sendAsBinary&&(XMLHttpRequest.prototype.sendAsBinary=function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t,0),s=0;s<e.length;s++)n[s]=255&e.charCodeAt(s);this.send(n)})}catch(e){}}function extendCollection(e,t){void 0!==e.nextPage&&(e.nextPage&&e.nextPage.split("/")[1]==Backendless.appVersion&&(e.nextPage=Backendless.serverURL+e.nextPage),e._nextPage=e.nextPage,e.nextPage=function(e){return t._load(this._nextPage,e)},e.getPage=function(e,n,s){var r=this._nextPage.replace(/offset=\d+/gi,"offset="+e);return n instanceof Async||(r=r.replace(/pagesize=\d+/gi,"pageSize="+n)),s=extractResponder(arguments),t._load(r,s)},e.dataMapper=t)}function Async(e,t,n){t instanceof Function||(n=t,t=emptyFn),this.success=function(t){e&&e.call(n,t)},this.fault=function(e){t&&t.call(n,e)}}function setCache(){function e(){try{return isBrowser&&s in window&&window[s]?(localStorage.setItem("localStorageTest",!0),localStorage.removeItem("localStorageTest"),!0):!1}catch(e){return!1}}var t,n={},s="localStorage";if(n.enabled=!1,n.exists=function(e){},n.set=function(e,t){},n.get=function(e){},n.remove=function(e){},n.clear=function(){},n.flushExpired=function(){},n.getCachePolicy=function(e){},n.getAll=function(){},n.serialize=function(e){return JSON.stringify(e)},n.deserialize=function(e){if("string"==typeof e)try{return JSON.parse(e)}catch(t){return e||void 0}},e()){t=window[s];var r=function(){"Backendless"in t||t.setItem("Backendless",n.serialize({}))},i=function(e){var t=!1;return"Object"==Object.prototype.toString.call(e).slice(8,-1)&&"cachePolicy"in e&&"timeToLive"in e.cachePolicy&&-1!=e.cachePolicy.timeToLive&&"created"in e.cachePolicy&&(t=(new Date).getTime()-e.cachePolicy.created>e.cachePolicy.timeToLive),t},a=function(e){"Object"==Object.prototype.toString.call(e).slice(8,-1)&&"cachePolicy"in e&&"timeToLive"in e.cachePolicy&&(e.cachePolicy.created=(new Date).getTime())};r(),n.enabled=!0,n.exists=function(e){return void 0!==n.get(e)},n.set=function(e,s){if(void 0===s)return n.remove(e);r();var i=n.deserialize(t.getItem("Backendless"));a(s),i[e]=s;try{t.setItem("Backendless",n.serialize(i))}catch(o){i={},i[e]=s,t.setItem("Backendless",n.serialize(i))}return s},n.get=function(e){r();var s=n.deserialize(t.getItem("Backendless")),a=s[e],o=a;return i(a)&&(delete s[e],t.setItem("Backendless",n.serialize(s)),o=void 0),o&&o.cachePolicy&&delete o.cachePolicy,o},n.remove=function(e){var s;r(),e=e.replace(/([^A-Za-z0-9-])/g,"");var i=n.deserialize(t.getItem("Backendless"));return i.hasOwnProperty(e)&&(s=delete i[e]),t.setItem("Backendless",n.serialize(i)),s},n.clear=function(){t.setItem("Backendless",n.serialize({}))},n.getAll=function(){r();var e=n.deserialize(t.getItem("Backendless")),s={};for(var i in e)e.hasOwnProperty(i)&&(s[i]=e[i],null!==s[i]&&s[i].hasOwnProperty("cachePolicy")&&delete s[i].cachePolicy);return s},n.flushExpired=function(){r();var e,s=n.deserialize(t.getItem("Backendless"));for(var a in s)s.hasOwnProperty(a)&&(e=s[a],i(e)&&(delete s[a],t.setItem("Backendless",n.serialize(s))))},n.getCachePolicy=function(e){r();var s=n.deserialize(t.getItem("Backendless")),i=s[e];return i?i.cachePolicy:void 0}}return n}function DataQuery(){this.properties=[],this.condition=null,this.options=null,this.url=null}function DataStore(e){if(this.model=Utils.isString(e)?function(){}:e,this.className=getClassName.call(e),"string"===(typeof e).toLowerCase()&&(this.className=e),!this.className)throw"Class name should be specified";this.restUrl=Backendless.appPath+"/data/"+this.className}function DataPermissions(){this.restUrl=Backendless.appPath+"/data",this.getRestUrl=function(e,t){return this.restUrl+"/"+encodeURIComponent(e.___class)+"/permissions/"+encodeURIComponent(t)+"/"+encodeURIComponent(e.objectId)},this.sendRequest=function(e,t,n,s,r,i){var a=extractResponder(arguments),o=null!=a,c={permission:s};if(!n.___class||!n.objectId)throw new Error('"dataObject.___class" and "dataObject.objectId" need to be specified');return e?c.user=e:t&&(c.role=t),Backendless._ajax({method:"PUT",url:this.getRestUrl(n,r),data:JSON.stringify(c),isAsync:o,asyncHandler:a})}}function User(){}function Geo(){this.restUrl=Backendless.appPath+"/geo",this.monitoringId=null}function Proxy(){}function PollingProxy(e){this.eventHandlers={},this.restUrl=e,this.timer=0,this.timeout=0,this.interval=1e3,this.xhr=null,this.needReconnect=!0,this.responder=new Async(this.onMessage,this.onError,this),this.poll()}function SocketProxy(e){var t=this;this.reconnectWithPolling=!0;try{var n=this.socket=new WebSocket(e);n.onopen=function(){return t.sockOpen()},n.onerror=function(e){return t.sockError(e)},n.onclose=function(){t.onSocketClose()},n.onmessage=function(e){return t.onMessage(e)}}catch(s){setTimeout(function(){t.onSocketClose()},100)}}function Subscription(e){this.channelName=e.channelName,this.options=e.options,this.channelProperties=e.channelProperties,this.subscriptionId=null,this.restUrl=e.restUrl+"/"+e.channelName,this.responder=e.responder||emptyFn,this._subscribe(e.onSubscribe)}function Messaging(){this.restUrl=Backendless.appPath+"/messaging",this.channelProperties={}}function getBuilder(e,t,n){var s="--",r="\r\n",i="";return i+=s,i+=n,i+=r,i+='Content-Disposition: form-data; name="file"',i+='; filename="'+e+'"',i+=r,i+="Content-Type: application/octet-stream",i+=r,i+=r,i+=t,i+=r,i+=s,i+=n,i+=s,i+=r}function send(e){var t=new XMLHttpRequest,n="-backendless-multipart-form-boundary-"+getNow(),s=getBuilder(this.fileName,e.target.result,n),r=function(e){var t={};try{t=JSON.parse(e.responseText)}catch(n){t.message=e.responseText}return t.statusCode=e.status,t};t.open("POST",this.uploadPath,!0),t.setRequestHeader("content-type","multipart/form-data; boundary="+n),t.setRequestHeader("application-id",Backendless.applicationId),t.setRequestHeader("secret-key",Backendless.secretKey),t.setRequestHeader("application-type","JS"),null!=currentUser&&currentUser["user-token"]?t.setRequestHeader("user-token",currentUser["user-token"]):Backendless.LocalCache.exists("user-token")&&t.setRequestHeader("user-token",Backendless.LocalCache.get("user-token")),null!==UIState&&t.setRequestHeader("uiState",UIState);var i=this.asyncHandler;if(i&&(t.onreadystatechange=function(){4==t.readyState&&(t.status>=200&&t.status<300?i.success(JSON.parse(t.responseText)):i.fault(JSON.parse(t.responseText)))}),t.sendAsBinary(s),i)return t;if(t.status>=200&&t.status<300)return t.responseText?JSON.parse(t.responseText):!0;throw r(t)}function sendEncoded(e){var t=new XMLHttpRequest,n=("-backendless-multipart-form-boundary-"+getNow(),function(e){var t={};try{t=JSON.parse(e.responseText)}catch(n){t.message=e.responseText}return t.statusCode=e.status,t});t.open("PUT",this.uploadPath,!0),t.setRequestHeader("Content-Type","text/plain"),t.setRequestHeader("application-id",Backendless.applicationId),t.setRequestHeader("secret-key",Backendless.secretKey),t.setRequestHeader("application-type","JS"),null!==UIState&&t.setRequestHeader("uiState",UIState);var s=this.asyncHandler;if(s&&(t.onreadystatechange=function(){4==t.readyState&&(t.status>=200&&t.status<300?s.success(JSON.parse(t.responseText)):s.fault(JSON.parse(t.responseText)))}),t.send(e.target.result.split(",")[1]),s)return t;if(t.status>=200&&t.status<300)return t.responseText?JSON.parse(t.responseText):!0;throw n(t)}function FilePermissions(){this.restUrl=Backendless.appPath+"/files/permissions"}function Files(){this.restUrl=Backendless.appPath+"/files"}function Commerce(){this.restUrl=Backendless.appPath+"/commerce/googleplay"}function Events(){this.restUrl=Backendless.appPath+"/servercode/events"}function Logging(e){this.name=e}function setLogMessage(e,t,n,s){var r={};r.message=n,r.timestamp=Date.now(),r.exception=s?s:null,r.logger=e,r["log-level"]=t,Backendless.Logging.logInfo.push(r),Backendless.Logging.messagesCount++,Backendless.Logging.checkMessagesLen()}function CustomServices(){}var NodeDevice={name:"NODEJS",platform:"NODEJS",uuid:"someId",version:"1"},isBrowser=new Function("try {return this===window;}catch(e){ return false;}")();isBrowser||(root=global);var Backendless=root.Backendless||{},emptyFn=function(){};root.Backendless=Backendless,Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var n;if(null==this)throw new TypeError('"this" is null or not defined');var s=Object(this),r=s.length>>>0;if(0===r)return-1;var i=+t||0;if(Math.abs(i)===1/0&&(i=0),i>=r)return-1;for(n=Math.max(i>=0?i:r-Math.abs(i),0);r>n;){if(n in s&&s[n]===e)return n;n++}return-1});var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,slice=ArrayProto.slice,unshift=ArrayProto.unshift,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,WebSocket=null;Backendless.VERSION="3.0.11",Backendless.serverURL="https://api.backendless.com",initXHR();var browser=function(){var e=isBrowser?navigator.userAgent.toLowerCase():"NodeJS",t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],n={browser:t[1]||"",version:t[2]||"0"},s={};return n.browser&&(s[n.browser]=!0,s.version=n.version),s}(),UIState=null,getNow=function(){return(new Date).getTime()};Backendless.browser=browser;var Utils=Backendless.Utils={isObject:function(e){return e===Object(e)},isString:function(e){return"String"===Object.prototype.toString.call(e).slice(8,-1)},isNumber:function(e){return"Number"===Object.prototype.toString.call(e).slice(8,-1)},isFunction:function(e){return"Function"===Object.prototype.toString.call(e).slice(8,-1)},isBoolean:function(e){return"Boolean"===Object.prototype.toString.call(e).slice(8,-1)},isDate:function(e){return"Date"===Object.prototype.toString.call(e).slice(8,-1)}};Utils.isArray=nativeIsArray||function(e){return"Array"===Object.prototype.toString.call(e).slice(8,-1)},Utils.addEvent=function(e,t,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent?t.attachEvent("on"+e,n):t[e]=n},Utils.isEmpty=function(e){if(null==e)return!0;if(Utils.isArray(e)||Utils.isString(e))return 0===e.length;for(var t in e)if(e.hasOwnProperty(t)&&void 0!==e[t]&&null!==e[t])return!1;return!0},Utils.removeEvent=function(e,t){t.removeEventListener?t.removeEventListener(e,null,!1):t.detachEvent?t.detachEvent("on"+e,null):t[e]=null},Backendless.setUIState=function(e){if(void 0===e)throw new Error("UI state name must be defined or explicitly set to null");UIState=null===e?null:e},Backendless._ajax_for_browser=function(e){var t=["cacheOnly","remoteDataOnly","fromCacheOrRemote","fromRemoteOrCache","fromCacheAndRemote"],n={ignoreCache:function(e){return s(e)},cacheOnly:function(e){var t=Backendless.LocalCache.get(e.url.replace(/([^A-Za-z0-9])/g,"")),n={message:"error: cannot find data in Backendless.LocalCache",statusCode:404};if(t)return e.isAsync&&e.asyncHandler.success(t),t;if(!e.isAsync)throw n;e.asyncHandler.fault(n)},remoteDataOnly:function(e){return s(e)},fromCacheOrRemote:function(e){var t=Backendless.LocalCache.get(e.url.replace(/([^A-Za-z0-9])/g,""));return t?(e.isAsync&&e.asyncHandler.success(t),t):s(e)},fromRemoteOrCache:function(e){return s(e)},fromCacheAndRemote:function(e){var t={},n=Backendless.LocalCache.get(e.url.replace(/([^A-Za-z0-9])/g,"")),r={message:"error: cannot find data in Backendless.LocalCache",statusCode:404};if(t.remote=s(e),n)e.isAsync&&e.asyncHandler.success(n),t.local=n;else{if(!e.isAsync)throw r;e.asyncHandler.fault(r)}return t}},s=function(e){var t,n=new XMLHttpRequest,s=e.data?"application/json":"application/x-www-form-urlencoded",r=function(e){var t=!0;if(e.responseText)try{t=JSON.parse(e.responseText)}catch(n){t=e.responseText}return t},i=function(e){var t={};try{t=JSON.parse(e.responseText)}catch(n){t.message=e.responseText}return t.statusCode=e.status,t.message=t.message||"unknown error occurred",t},a=function(t){t=cloneObject(t),"GET"==e.method&&e.cacheActive?(t.cachePolicy=e.cachePolicy,Backendless.LocalCache.set(e.urlBlueprint,t)):Backendless.LocalCache.exists(e.urlBlueprint)&&(t===!0||"DELETE"==e.method?t=void 0:t.cachePolicy=Backendless.LocalCache.getCachePolicy(e.urlBlueprint),"___class"in t&&delete t.___class,Backendless.LocalCache.set(e.urlBlueprint,t))},o=function(){return e.cacheActive&&"fromRemoteOrCache"==e.cachePolicy.policy&&Backendless.LocalCache.exists(e.urlBlueprint)};if(n.open(e.method,e.url,e.isAsync),n.setRequestHeader("Content-Type",s),n.setRequestHeader("application-id",Backendless.applicationId),n.setRequestHeader("secret-key",Backendless.secretKey),n.setRequestHeader("application-type","JS"),null!=currentUser&&currentUser["user-token"]?n.setRequestHeader("user-token",currentUser["user-token"]):Backendless.LocalCache.exists("user-token")&&n.setRequestHeader("user-token",Backendless.LocalCache.get("user-token")),null!==UIState&&n.setRequestHeader("uiState",UIState),e.isAsync&&(n.onreadystatechange=function(){4==n.readyState&&(n.status>=200&&n.status<300?(t=r(n),a(t),e.asyncHandler.success&&e.asyncHandler.success(t)):o()?e.asyncHandler.success&&e.asyncHandler.success(Backendless.LocalCache.get(e.urlBlueprint)):e.asyncHandler.fault&&e.asyncHandler.fault(i(n)))}),n.send(e.data),e.isAsync)return n;if(n.status>=200&&n.status<300)return t=r(n),a(t),t;if(o())return Backendless.LocalCache.get(e.urlBlueprint);throw i(n)};e.method=e.method||"GET",e.cachePolicy=e.cachePolicy||{policy:"ignoreCache"},e.isAsync="boolean"==typeof e.isAsync?e.isAsync:!1,e.cacheActive="GET"==e.method&&-1!=t.indexOf(e.cachePolicy.policy),e.urlBlueprint=e.url.replace(/([^A-Za-z0-9])/g,"");try{return n[e.cachePolicy.policy].call(this,e)}catch(r){throw console.log("error: "+r.message),r}},Backendless._ajax_for_nodejs=function(e){e.data=e.data||"","string"!=typeof e.data&&(e.data=JSON.stringify(e.data)),e.asyncHandler=e.asyncHandler||{},e.isAsync="boolean"==typeof e.isAsync?e.isAsync:!1;var t=e.url.substr(0,e.url.indexOf("/",8)).substr(0,e.url.indexOf(":")),n=e.url.substr(0,e.url.indexOf("/",8)).substr(e.url.indexOf("/")+2),s=n.substr(0,-1==n.indexOf(":")?n.length:n.indexOf(":")),r=-1!=n.indexOf(":")?parseInt(n.substr(n.indexOf(":")+1)):"http"==t?80:443,i={host:s,port:r,method:e.method||"GET",path:e.url.substr(e.url.indexOf("/",8)),headers:{"Content-Length":e.data?Buffer.byteLength(e.data):0,"Content-Type":e.data?"application/json":"application/x-www-form-urlencoded","application-id":Backendless.applicationId,"secret-key":Backendless.secretKey,"application-type":"JS"}},a="";if(null!=currentUser&&currentUser["user-token"]&&(i.headers["user-token"]=currentUser["user-token"]),!e.isAsync)throw new Error("Use Async type of request using Backendless with NodeJS. Add Backendless.Async(successCallback, errorCallback) as last argument");var o=require(t),c=o.request(i,function(t){t.setEncoding("utf8"),t.on("data",function(e){a+=e}),t.on("end",function(){var n=e.asyncHandler[t.statusCode>=200&&t.statusCode<300?"success":"fault"];Utils.isFunction(n)&&n(a)})});return c.on("error",function(t){e.asyncHandler.fault||(e.asyncHandler.fault=function(){}),e.asyncHandler.fault(t)}),c.write(e.data,"utf8"),c.end()},Backendless._ajax=isBrowser?Backendless._ajax_for_browser:Backendless._ajax_for_nodejs;var getClassName=function(){if(this.prototype&&this.prototype.___class)return this.prototype.___class;var e=Utils.isFunction(this)?this.toString():this.constructor.toString(),t=e.match(/function\s+(\w+)/);return t&&t.length>1?t[1]:""},encodeArrayToUriComponent=function(e){var t,n,s=[];for(t=0,n=e.length;n>t;++t)s.push(encodeURIComponent(e[t]));return s.join(",")},classWrapper=function(obj){var wrapper=function(obj){var wrapperName=null,wrapperFunc=null;for(var property in obj)if(obj.hasOwnProperty(property)&&"___class"===property){wrapperName=obj[property];break}if(wrapperName)try{wrapperFunc=eval(wrapperName),obj=deepExtend(new wrapperFunc,obj)}catch(e){}return obj};if(Utils.isObject(obj)&&null!=obj)if(Utils.isArray(obj))for(var i=obj.length;i--;)obj[i]=wrapper(obj[i]);else obj=wrapper(obj);return obj},deepExtend=function(e,t){for(var n in t)void 0!==t[n]&&t.hasOwnProperty(n)&&(e[n]=e[n]||{},e[n]=classWrapper(t[n]),e[n]&&e[n].hasOwnProperty(n)&&e[n][n]&&e[n][n].hasOwnProperty("__originSubID")&&(e[n][n]=classWrapper(e[n])));return e},cloneObject=function(e){return Utils.isArray(e)?e.slice():deepExtend({},e)},extractResponder=function(e){var t,n;for(t=0,n=e.length;n>t;++t)if(e[t]instanceof Async)return e[t];return null};Backendless.LocalCache=setCache(),Backendless.LocalCache.enabled&&Backendless.LocalCache.flushExpired(),Backendless.Async=Async,DataQuery.prototype={addProperty:function(e){this.properties=this.properties||[],this.properties.push(e)}},Backendless.DataQuery=DataQuery,DataStore.prototype={_extractQueryOptions:function(e){var t=[];if("undefined"!=typeof e.pageSize){if(e.pageSize<1||e.pageSize>100)throw new Error("PageSize can not be less then 1 or greater than 100");t.push("pageSize="+encodeURIComponent(e.pageSize))}if("undefined"!=typeof e.offset){if(e.offset<0)throw new Error("Offset can not be less then 0");t.push("offset="+encodeURIComponent(e.offset))}return e.sortBy&&(Utils.isString(e.sortBy)?t.push("sortBy="+encodeURIComponent(e.sortBy)):Utils.isArray(e.sortBy)&&t.push("sortBy="+encodeArrayToUriComponent(e.sortBy))),e.relationsDepth&&Utils.isNumber(e.relationsDepth)&&t.push("relationsDepth="+Math.floor(e.relationsDepth)),e.relations&&Utils.isArray(e.relations)&&t.push("loadRelations="+(e.relations.length?encodeArrayToUriComponent(e.relations):"*")),t.join("&")},_wrapAsync:function(e){var t=this,n=function(n){n=t._parseResponse(n),e.success(n)},s=function(t){e.fault(t)};return new Async(n,s)},_parseResponse:function(e){var t,n=this.model;return e=e.fields||e,t=new n,isBrowser||(e=JSON.parse(e)),extendCollection(e,this),deepExtend(t,e),this._formCircDeps(t)},_parseFindResponse:function(e){var t,n,s,r=this.model;if(e.data){var i=e,a=i.data;for(t=0,n=a.length;n>t;++t)a[t]=a[t].fields||a[t],s=new r,deepExtend(s,a[t]),a[t]=s;return extendCollection(i,this),i}return e=e.fields||e,s=Utils.isString(r)?{}:new r,deepExtend(s,e),this._formCircDeps(s)},_load:function(e,t){if(e){var n=extractResponder(arguments),s=!1;null!=n&&(s=!0,n=this._wrapAsync(n));var r=Backendless._ajax({method:"GET",url:e,isAsync:s,asyncHandler:n});return s?r:this._parseResponse(r)}},_replCircDeps:function(e){var t,n=[e],s=function(){for(var e="",t=e;t++<36;e+=51*t?(15^t?8^Math.random()*(20^t?16:4):4).toString(16):"-");return e},r=function(e){for(var i in e)e.hasOwnProperty(i)&&"object"==typeof e[i]&&null!=e[i]&&(-1!=(t=n.indexOf(e[i]))?(n[t].__subID=n[t].__subID||s(),e[i]={__originSubID:n[t].__subID}):Utils.isDate(e[i])?e[i]=e[i].getTime():(n.push(e[i]),r(e[i])))};r(e)},_formCircDeps:function(e){var t={},n=new e.constructor,s=function(e,n){e.hasOwnProperty("__subID")&&(t[e.__subID]=n,delete e.__subID);for(var r in e)e.hasOwnProperty(r)&&("object"==typeof e[r]&&null!=e[r]?e[r].hasOwnProperty("__originSubID")?n[r]=t[e[r].__originSubID]:(n[r]=new e[r].constructor,s(e[r],n[r])):n[r]=e[r])};return s(e,n),n},save:function(e,t){this._replCircDeps(e);var n=extractResponder(arguments),s=!1,r="PUT",i=this.restUrl,a=e;null!=n&&(s=!0,n=this._wrapAsync(n));var o=Backendless._ajax({method:r,url:i,data:JSON.stringify(e),isAsync:s,asyncHandler:n});return s||deepExtend(a,this._parseResponse(o)),s?o:this._parseResponse(o)},remove:function(e,t){if(!Utils.isObject(e)&&!Utils.isString(e))throw new Error('Invalid value for the "value" argument. The argument must contain only string or object values');var n=extractResponder(arguments),s=!1;null!=n&&(s=!0,n=this._wrapAsync(n));var r;return Utils.isString(e)||e.objectId?(e=e.objectId||e,r=Backendless._ajax({method:"DELETE",url:this.restUrl+"/"+e,isAsync:s,asyncHandler:n})):r=Backendless._ajax({method:"DELETE",url:this.restUrl,data:JSON.stringify(e),isAsync:s,asyncHandler:n}),s?r:this._parseResponse(r)},find:function(e){e=e||{};var t,n,s,r,i=[],a=this.restUrl,o=extractResponder(arguments),c=null!=o;return e.properties&&e.properties.length&&(t="props="+encodeArrayToUriComponent(e.properties)),e.condition&&(n="where="+encodeURIComponent(e.condition)),e.options&&(s=this._extractQueryOptions(e.options)),null!=o&&(o=this._wrapAsync(o)),s&&i.push(s),n&&i.push(n),t&&i.push(t),i=i.join("&"),e.url&&(a+="/"+e.url),i&&(a+="?"+i),r=Backendless._ajax({method:"GET",url:a,isAsync:c,asyncHandler:o,cachePolicy:e.cachePolicy}),c?r:this._parseFindResponse(r)},_buildArgsObject:function(){for(var e={},t=arguments.length,n="";t--;)switch(n=Object.prototype.toString.call(arguments[t]).toLowerCase().match(/[a-z]+/g)[1]){case"number":e.options=e.options||{},e.options.relationsDepth=arguments[t];break;case"string":e.url=arguments[t];break;case"array":e.options=e.options||{},e.options.relations=arguments[t];break;case"object":arguments[t].hasOwnProperty("cachePolicy")&&(e.cachePolicy=arguments[t].cachePolicy)}return e},findById:function(){var e;if(Utils.isString(arguments[0])){if(e=this._buildArgsObject.apply(this,arguments),!e.url)throw new Error('missing argument "object ID" for method findById()');return this.find.apply(this,[e].concat(Array.prototype.slice.call(arguments)))}if(Utils.isObject(arguments[0])){e=arguments[0];var t=extractResponder(arguments),n=this.restUrl,s=null!=t,r="/pk?";for(var i in e)r+=i+"="+e[i]+"&";null!=t&&(t=this._wrapAsync(t));var a;return a="Object"==getClassName.call(arguments[0])?Backendless._ajax({method:"GET",url:n+r.replace(/&$/,""),isAsync:s,asyncHandler:t}):Backendless._ajax({method:"PUT",url:n,data:JSON.stringify(e),isAsync:s,asyncHandler:t}),s?a:this._parseResponse(a)}throw new Error('Invalid value for the "value" argument. The argument must contain only string or object values')},loadRelations:function(e){if(!e)throw new Error("missing object argument for method loadRelations()");if(!Utils.isObject(e))throw new Error('Invalid value for the "value" argument. The argument must contain only object values');var t=arguments[0],n=this.restUrl+"/relations";if(arguments[1]){if(!Utils.isArray(arguments[1]))throw new Error('Invalid value for the "options" argument. The argument must contain only array values');n+="*"==arguments[1][0]?"?relationsDepth="+arguments[1].length:"?loadRelations="+arguments[1][0]+"&relationsDepth="+arguments[1].length}var s=Backendless._ajax({method:"PUT",url:n,data:JSON.stringify(t)});deepExtend(e,s)},findFirst:function(){var e=this._buildArgsObject.apply(this,arguments);return e.url="first",this.find.apply(this,[e].concat(Array.prototype.slice.call(arguments)))},findLast:function(){var e=this._buildArgsObject.apply(this,arguments);return e.url="last",this.find.apply(this,[e].concat(Array.prototype.slice.call(arguments)))}};var dataStoreCache={},persistence={save:function(e,t,n){var s=extractResponder(arguments),r=!1;if(Utils.isString(e)){var i=Backendless.appPath+"/data/"+e;return Backendless._ajax({method:"POST",url:i,data:JSON.stringify(t),isAsync:r,asyncHandler:s})}return Utils.isObject(e)?new DataStore(e).save(e,t,n):void 0},getView:function(e,t,n,s,r){var i=extractResponder(arguments),a=null!=i;if(Utils.isString(e)){var o=Backendless.appPath+"/data/"+e;return arguments.length>1&&!(arguments[1]instanceof Backendless.Async)&&(o+="?"),Utils.isString(t)?o+="where="+t:(n=t,s=n),Utils.isNumber(n)&&(o+="&"+(new DataStore)._extractQueryOptions({pageSize:n})),Utils.isNumber(s)&&(o+="&"+(new DataStore)._extractQueryOptions({offset:s})),Backendless._ajax({method:"GET",url:o,isAsync:a,asyncHandler:i})}throw new Error("View name is required string parameter")},callStoredProcedure:function(e,t,n){var s=extractResponder(arguments),r=null!=s;if(Utils.isString(e)){var i=Backendless.appPath+"/data/"+e,a={};return Utils.isObject(t)&&(a=JSON.stringify(t)),Backendless._ajax({method:"POST",url:i,data:a,isAsync:r,asyncHandler:s})}throw new Error("Stored Procedure name is required string parameter")},of:function(e){var t;if(Utils.isString(e)){if("users"===e.toLowerCase())throw new Error("Table 'Users' is not accessible through this signature. Use Backendless.Data.of( BackendlessUser.class ) instead");t=e}else t=getClassName.call(e);var n=dataStoreCache[t];return n||(n=new DataStore(e),dataStoreCache[t]=n),n},describe:function(e,t){e=Utils.isString(e)?e:getClassName.call(e);var n=extractResponder(arguments),s=null!=n;return Backendless._ajax({method:"GET",url:Backendless.appPath+"/data/"+e+"/properties",isAsync:s,asyncHandler:n})}};DataPermissions.prototype={FIND:{grantUser:function(e,t,n){return Backendless.Data.Permissions.sendRequest(e,null,t,"FIND","GRANT",n)},grantRole:function(e,t,n){return Backendless.Data.Permissions.sendRequest(null,e,t,"FIND","GRANT",n)},grant:function(e,t){return Backendless.Data.Permissions.sendRequest("*",null,e,"FIND","GRANT",t)},denyUser:function(e,t,n){return Backendless.Data.Permissions.sendRequest(e,null,t,"FIND","DENY",n)},denyRole:function(e,t,n){return Backendless.Data.Permissions.sendRequest(null,e,t,"FIND","DENY",n)},deny:function(e,t){return Backendless.Data.Permissions.sendRequest("*",null,e,"FIND","DENY",t)}},REMOVE:{grantUser:function(e,t,n){return Backendless.Data.Permissions.sendRequest(e,null,t,"REMOVE","GRANT",n)},grantRole:function(e,t,n){return Backendless.Data.Permissions.sendRequest(null,e,t,"REMOVE","GRANT",n)},grant:function(e,t){return Backendless.Data.Permissions.sendRequest("*",null,e,"REMOVE","GRANT",t)},denyUser:function(e,t,n){return Backendless.Data.Permissions.sendRequest(e,null,t,"REMOVE","DENY",n)},denyRole:function(e,t,n){return Backendless.Data.Permissions.sendRequest(null,e,t,"REMOVE","DENY",n)},deny:function(e,t){return Backendless.Data.Permissions.sendRequest("*",null,e,"REMOVE","DENY",t)}},UPDATE:{grantUser:function(e,t,n){return Backendless.Data.Permissions.sendRequest(e,null,t,"UPDATE","GRANT",n)},grantRole:function(e,t,n){return Backendless.Data.Permissions.sendRequest(null,e,t,"UPDATE","GRANT",n)},grant:function(e,t){return Backendless.Data.Permissions.sendRequest("*",null,e,"UPDATE","GRANT",t)},denyUser:function(e,t,n){return Backendless.Data.Permissions.sendRequest(e,null,t,"UPDATE","DENY",n)},denyRole:function(e,t,n){return Backendless.Data.Permissions.sendRequest(null,e,t,"UPDATE","DENY",n)},deny:function(e,t){return Backendless.Data.Permissions.sendRequest("*",null,e,"UPDATE","DENY",t)}}},User.prototype.___class="Users",Backendless.User=User;var currentUser=null,UserService=function(){this.restUrl=Backendless.appPath+"/users"};UserService.prototype={_wrapAsync:function(e){var t=this,n=function(n){try{n=JSON.parse(n)}catch(s){}currentUser=t._parseResponse(n),e.success(t._getUserFromResponse(currentUser))},s=function(t){e.fault(t)};return new Async(n,s)},_parseResponse:function(e){var t=new Backendless.User;return deepExtend(t,e),t},register:function(e,t){if(!(e instanceof Backendless.User))throw new Error("Only Backendless.User accepted");var n=extractResponder(arguments),s=null!=n;n&&(n=this._wrapAsync(n));var r=Backendless._ajax({method:"POST",url:this.restUrl+"/register",isAsync:s,asyncHandler:n,data:JSON.stringify(e)});return s?r:this._parseResponse(r)},getUserRoles:function(e){var t=extractResponder(arguments),n=null!=t;t&&(t=this._wrapAsync(t));var s=Backendless._ajax({method:"GET",url:this.restUrl+"/userroles",isAsync:n,asyncHandler:t});return n?s:this._parseResponse(s)},roleHelper:function(e,t,n,s){if(!e)throw new Error("Username can not be empty");if(!t)throw new Error("Rolename can not be empty");var r=extractResponder(arguments),i=null!=r;r&&(r=this._wrapAsync(r));var a={user:e,roleName:t};return Backendless._ajax({method:"POST",url:this.restUrl+"/"+s,isAsync:i,asyncHandler:r,data:JSON.stringify(a)})},assignRole:function(e,t,n){return this.roleHelper(e,t,n,"assignRole")},unassignRole:function(e,t,n){return this.roleHelper(e,t,n,"unassignRole")},login:function(e,t,n,s){if(!e)throw new Error("Username can not be empty");if(!t)throw new Error("Password can not be empty");Backendless.LocalCache.remove("user-token"),Backendless.LocalCache.remove("current-user-id"),Backendless.LocalCache.set("stayLoggedIn",!1),Utils.isBoolean(n)&&Backendless.LocalCache.set("stayLoggedIn",n);var r=extractResponder(arguments),i=null!=r;r&&(r=this._wrapAsync(r));var a={login:e,password:t},o=Backendless._ajax({method:"POST",url:this.restUrl+"/login",isAsync:i,asyncHandler:r,data:JSON.stringify(a)});return i?o:(currentUser=this._parseResponse(o),this._getUserFromResponse(currentUser))},_getUserFromResponse:function(e){Backendless.LocalCache.set("current-user-id",e.objectId);var t=new Backendless.User;for(var n in e)if(e.hasOwnProperty(n)){if("user-token"==n){Backendless.LocalCache.get("stayLoggedIn")&&Backendless.LocalCache.set("user-token",e[n]);continue}t[n]=e[n]}return t},loggedInUser:function(){return Backendless.LocalCache.get("current-user-id")},describeUserClass:function(e){var t=extractResponder(arguments),n=null!=t;return Backendless._ajax({method:"GET",url:this.restUrl+"/userclassprops",isAsync:n,asyncHandler:t})},restorePassword:function(e,t){if(!e)throw"Username can not be empty";var n=extractResponder(arguments),s=null!=n;return Backendless._ajax({method:"GET",url:this.restUrl+"/restorepassword/"+encodeURIComponent(e),isAsync:s,asyncHandler:n})},logout:function(e){var t=extractResponder(arguments),n=null!=t,s=n?t.fault:null,r=n?t.success:null,i=function(){Backendless.LocalCache.remove("user-token"),Backendless.LocalCache.remove("current-user-id"),Backendless.LocalCache.remove("stayLoggedIn"),currentUser=null},a=function(){i(),Utils.isFunction(r)&&r()},o=function(e){Utils.isObject(e)&&-1!=[3064,3091,3090,3023].indexOf(e.code)&&i(),Utils.isFunction(s)&&s(e)};t&&(t.fault=o,t.success=a);try{var c=Backendless._ajax({method:"GET",url:this.restUrl+"/logout",isAsync:n,asyncHandler:t})}catch(l){o(l)}return n?c:void i()},getCurrentUser:function(){if(currentUser)return this._getUserFromResponse(currentUser);if(Backendless.LocalCache.get("stayLoggedIn")){var e=Backendless.LocalCache.get("current-user-id");return Backendless.Data.of(Backendless.User).findById(e)}return null},update:function(e,t){var n=extractResponder(arguments),s=null!=n;n&&(n=this._wrapAsync(n));var r=Backendless._ajax({method:"PUT",url:this.restUrl+"/"+e.objectId,isAsync:s,asyncHandler:n,data:JSON.stringify(e)});return s?r:this._parseResponse(r)},loginWithFacebook:function(e,t,n,s){this._loginSocial("Facebook",e,t,n,s)},loginWithGooglePlus:function(e,t,n,s){this._loginSocial("GooglePlus",e,t,n,s)},loginWithTwitter:function(e,t){this._loginSocial("Twitter",e,null,t,null)},_socialContainer:function(e,t){var n;if(t){var s;t=t[0],n=document.createElement("div"),n.innerHTML="Loading...",t.appendChild(n),t.style.cursor="wait",this.closeContainer=function(){t.style.cursor="default",t.removeChild(s)},this.removeLoading=function(){t.removeChild(n)},this.doAuthorizationActivity=function(e){this.removeLoading(),s=document.createElement("iframe"),s.frameBorder=0,s.width=t.style.width,s.height=t.style.height,s.id="SocialAuthFrame",s.setAttribute("src",e+"&amp;output=embed"),t.appendChild(s),s.onload=function(){t.style.cursor="default"}}}else t=window.open("",e+" authorization","height=250,width=450,scrollbars=0,toolbar=0,menubar=0,location=0,resizable=0,status=0,titlebar=0",!1),n=t.document.getElementsByTagName("body")[0].innerHTML,n="Loading...",t.document.getElementsByTagName("html")[0].style.cursor="wait",this.closeContainer=function(){t.close()},this.removeLoading=function(){n=null},this.doAuthorizationActivity=function(e){t.location.href=e,t.onload=function(){t.document.getElementsByTagName("html")[0].style.cursor="default";
}}},_loginSocial:function(e,t,n,s,r){var i=new this._socialContainer(e,r),a=extractResponder(arguments);a&&(a=this._wrapAsync(a)),Utils.addEvent("message",window,function(e){if(e.origin==Backendless.serverURL){var t=JSON.parse(e.data);t.fault?a.fault(t.fault):(currentUser=this.Backendless.UserService._parseResponse(t),a.success(this.Backendless.UserService._getUserFromResponse(currentUser))),Utils.removeEvent("message",window),i.closeContainer()}});var o=new Backendless.Async(function(e){i.doAuthorizationActivity(e)},function(e){i.closeContainer(),a.fault(e)}),c=t||n?{}:null;t&&(c.fieldsMapping=t),n&&(c.permissions=n),Backendless._ajax({method:"POST",url:this.restUrl+"/social/oauth/"+e.toLowerCase()+"/request_url",isAsync:!0,asyncHandler:o,data:JSON.stringify(c)})},loginWithFacebookSdk:function(e,t){if(!FB)throw new Error("Facebook SDK not found");var n=this;FB.getLoginStatus(function(s){"connected"===s.status?n._sendSocialLoginRequest(n,s,"facebook",e,t):FB.login(function(s){n._sendSocialLoginRequest(n,s,"facebook",e,t)})})},loginWithGooglePlusSdk:function(e,t){if(!gapi)throw new Error("Google Plus SDK not found");var n=this;gapi.auth.authorize({client_id:e.client_id,scope:"https://www.googleapis.com/auth/plus.login"},function(s){delete s["g-oauth-window"],n._sendSocialLoginRequest(n,s,"googleplus",e,t)})},_sendSocialLoginRequest:function(e,t,n,s,r){s&&(t.fieldsMapping=s);var i=new Backendless.Async(function(t){currentUser=e._parseResponse(t),r.success(e._getUserFromResponse(currentUser))},function(e){r.fault(e)});Backendless._ajax({method:"POST",url:e.restUrl+"/social/"+n+"/login/"+Backendless.applicationId,isAsync:!0,asyncHandler:i,data:JSON.stringify(t)})},isValidLogin:function(e){var t="",n=Backendless.LocalCache,s=extractResponder(arguments),r=null!=s;if(s&&(s=this._wrapAsync(s)),!n.get("user-token")){var i=Backendless.UserService.getCurrentUser();return!!i}if(t=n.get("user-token"),e)Backendless._ajax({method:"GET",url:Backendless.serverURL+"/"+Backendless.appVersion+"/users/isvalidusertoken/"+t,isAsync:r,asyncHandler:s});else try{var a=Backendless._ajax({method:"GET",url:Backendless.serverURL+"/"+Backendless.appVersion+"/users/isvalidusertoken/"+t});return!!a}catch(o){return!1}}},Geo.prototype={UNITS:{METERS:"METERS",KILOMETERS:"KILOMETERS",MILES:"MILES",YARDS:"YARDS",FEET:"FEET"},_wrapAsync:function(e){var t=this,n=function(n){n=t._parseResponse(n),e.success(n)},s=function(t){e.fault(t)};return new Async(n,s)},_parseResponse:function(e){var t=e.collection;return extendCollection(t,this),t},_load:function(e,t){var n=extractResponder(arguments),s=null!=n,r=Backendless._ajax({method:"GET",url:e,isAsync:s,asyncHandler:n});return s?r:this._parseResponse(r)},_findHelpers:{searchRectangle:function(e){var t=["nwlat="+e[0],"nwlon="+e[1],"selat="+e[2],"selon="+e[3]];return t.join("&")},latitude:function(e){return"lat="+e},longitude:function(e){return"lon="+e},metadata:function(e){return"metadata="+JSON.stringify(e)},units:function(e){return"units="+e},radius:function(e){return"r="+e},categories:function(e){return e=Utils.isString(e)?[e]:e,"categories="+encodeArrayToUriComponent(e)},includeMetadata:function(e){return"includemetadata="+e},pageSize:function(e){if(1>e||e>100)throw new Error("PageSize can not be less then 1 or greater than 100");return"pagesize="+e},offset:function(e){if(0>e)throw new Error("Offset can not be less then 0");return"offset="+e},relativeFindPercentThreshold:function(e){if(0>=e)throw new Error("Threshold can not be less then or equal 0");return"relativeFindPercentThreshold="+e},relativeFindMetadata:function(e){return"relativeFindMetadata="+encodeURIComponent(JSON.stringify(e))},condition:function(e){return"whereClause="+encodeURIComponent(e)},degreePerPixel:function(e){return"dpp="+e},clusterGridSize:function(e){return"clustergridsize="+e},geoFence:function(e){return"geoFence="+e}},addPoint:function(e,t){if(void 0===e.latitude||void 0===e.longitude)throw"Latitude or longitude not a number";e.categories=e.categories||["Default"],e.categories=Utils.isArray(e.categories)?e.categories:[e.categories];var n=extractResponder(arguments),s=function(e){var t=function(t){var n=t.geopoint,s=new GeoPoint;s.categories=n.categories,s.latitude=n.latitude,s.longitude=n.longitude,s.metadata=n.metadata,s.objectId=n.objectId,t.geopoint=s,e.success(t)},n=function(t){e.fault(t)};return new Async(t,n)};if(null!=n)var r=!0;return n=s(n),Backendless._ajax({method:"PUT",url:this.restUrl+"/points",data:JSON.stringify(e),isAsync:r,asyncHandler:n})},findUtil:function(e,t){var n=e.url,s=extractResponder(arguments),r=!1;if(e.searchRectangle&&e.radius)throw new Error("Inconsistent geo query. Query should not contain both rectangle and radius search parameters.");if(e.radius&&(void 0===e.latitude||void 0===e.longitude))throw new Error("Latitude and longitude should be provided to search in radius");if(!(!e.relativeFindMetadata&&!e.relativeFindPercentThreshold||e.relativeFindMetadata&&e.relativeFindPercentThreshold))throw new Error("Inconsistent geo query. Query should contain both relativeFindPercentThreshold and relativeFindMetadata or none of them");n+=e.searchRectangle?"/rect?":"/points?",n+=e.units?"units="+e.units:"";for(var i in e)e.hasOwnProperty(i)&&this._findHelpers.hasOwnProperty(i)&&void 0!=e[i]&&(n+="&"+this._findHelpers[i](e[i]));n=n.replace(/\?&/g,"?");var a=this,o=function(t){var n=function(n){for(var s=n.collection.data,r=0;r<s.length;r++){var i=null;s[r].hasOwnProperty("totalPoints")?(i=new GeoCluster,i.totalPoints=s[r].totalPoints,i.geoQuery=e):i=new GeoPoint,i.categories=s[r].categories,i.latitude=s[r].latitude,i.longitude=s[r].longitude,i.metadata=s[r].metadata,i.objectId=s[r].objectId,i.distance=s[r].distance,n.collection.data[r]=i}n=a._parseResponse(n),t.success(n)},s=function(e){t.fault(e)};return new Async(n,s)};null!=s&&(r=!0),s=o(s);var c=Backendless._ajax({method:"GET",url:n,isAsync:r,asyncHandler:s});return r?c:this._parseResponse(c)},find:function(e,t){return e.url=this.restUrl,this.findUtil(e,t)},loadMetadata:function(e,t){var n=this.restUrl+"/points/",s=extractResponder(arguments),r=!1;if(!e.objectId)throw new Error("Method argument must be a valid instance of GeoPoint or GeoCluster persisted on the server");if(e instanceof GeoCluster){if(!(e.geoQuery instanceof BackendlessGeoQuery))throw new Error("Invalid GeoCluster object. Make sure to obtain an instance of GeoCluster using the Backendless.Geo.find API");n+=e.objectId+"/metadata?";for(var i in e.geoQuery)e.geoQuery.hasOwnProperty(i)&&this._findHelpers.hasOwnProperty(i)&&void 0!=e.geoQuery[i]&&(n+="&"+this._findHelpers[i](e.geoQuery[i]))}else{if(!(e instanceof GeoPoint))throw new Error("Method argument must be a valid instance of GeoPoint or GeoCluster persisted on the server");n+=e.objectId+"/metadata"}return null!=s&&(r=!0),Backendless._ajax({method:"GET",url:n,isAsync:r,asyncHandler:s})},getClusterPoints:function(e,t){var n=this.restUrl+"/clusters/",s=extractResponder(arguments),r=!1;if(!e.objectId)throw new Error("Method argument must be a valid instance of GeoCluster persisted on the server");if(!(e instanceof GeoCluster))throw new Error("Method argument must be a valid instance of GeoCluster persisted on the server");if(!(e.geoQuery instanceof BackendlessGeoQuery))throw new Error("Invalid GeoCluster object. Make sure to obtain an instance of GeoCluster using the Backendless.Geo.find API");n+=e.objectId+"/points?";for(var i in e.geoQuery)e.geoQuery.hasOwnProperty(i)&&this._findHelpers.hasOwnProperty(i)&&void 0!=e.geoQuery[i]&&(n+="&"+this._findHelpers[i](e.geoQuery[i]));var a=this,o=function(e){var t=function(t){for(var n=t.collection.data,s=0;s<n.length;s++){var r=null;r=new GeoPoint,r.categories=n[s].categories,r.latitude=n[s].latitude,r.longitude=n[s].longitude,r.metadata=n[s].metadata,r.objectId=n[s].objectId,t.collection.data[s]=r}t=a._parseResponse(t),e.success(t)},n=function(t){e.fault(t)};return new Async(t,n)};null!=s&&(r=!0),s=o(s);var c=Backendless._ajax({method:"GET",url:n,isAsync:r,asyncHandler:s});return r?c:this._parseResponse(c)},relativeFind:function(e,t){if(e.relativeFindMetadata&&e.relativeFindPercentThreshold)return e.url=this.restUrl+"/relative",this.findUtil(e,t);throw new Error("Inconsistent geo query. Query should contain both relativeFindPercentThreshold and relativeFindMetadata")},addCategory:function(e,t){if(!e)throw new Error("Category name is required.");var n=extractResponder(arguments),s=null!=n,r=Backendless._ajax({method:"PUT",url:this.restUrl+"/categories/"+e,isAsync:s,asyncHandler:n});return"undefined"==typeof r.result?r:r.result},getCategories:function(e){var t=extractResponder(arguments),n=null!=t;return Backendless._ajax({method:"GET",url:this.restUrl+"/categories",isAsync:n,asyncHandler:t})},deleteCategory:function(e,t){if(!e)throw new Error("Category name is required.");var n=extractResponder(arguments),s=null!=n;try{var r=Backendless._ajax({method:"DELETE",url:this.restUrl+"/categories/"+e,isAsync:s,asyncHandler:n})}catch(i){if(404!=i.statusCode)throw i;r=!1}return"undefined"==typeof r.result?r:r.result},deletePoint:function(e,t){if(!e||Utils.isFunction(e))throw new Error("Point argument name is required, must be string (object Id), or point object");var n=Utils.isString(e)?e:e.objectId,s=extractResponder(arguments),r=null!=s;try{var i=Backendless._ajax({method:"DELETE",url:this.restUrl+"/points/"+n,isAsync:r,asyncHandler:s})}catch(a){if(404!=a.statusCode)throw a;i=!1}return"undefined"==typeof i.result?i:i.result},getFencePoints:function(e,t,n){if(t=t||new BackendlessGeoQuery,!Utils.isString(e))throw new Error("Invalid value for parameter 'geoFenceName'. Geo Fence Name must be a String");if(!(t instanceof BackendlessGeoQuery))throw new Error("Invalid geo query. Query should be instance of BackendlessGeoQuery");return t.geoFence=e,t.url=this.restUrl,this.findUtil(t,n)},_runFenceAction:function(e,t,n,s){if(!Utils.isString(t))throw new Error("Invalid value for parameter 'geoFenceName'. Geo Fence Name must be a String");if(n&&!(n instanceof Backendless.Async)&&!(n instanceof GeoPoint)&&!n.objectId)throw new Error("Method argument must be a valid instance of GeoPoint persisted on the server");var r=extractResponder(arguments),i=null!=r,a={method:"POST",url:this.restUrl+"/fence/"+e+"?geoFence="+t,isAsync:i,asyncHandler:r};return n&&(a.data=JSON.stringify(n)),Backendless._ajax(a)},runOnStayAction:function(e,t,n){return this._runFenceAction("onstay",e,t,n)},runOnExitAction:function(e,t,n){return this._runFenceAction("onexit",e,t,n)},runOnEnterAction:function(e,t,n){return this._runFenceAction("onenter",e,t,n)},_getFences:function(e){return Backendless._ajax({method:"GET",url:this.restUrl+"/fences"+(e?"?geoFence="+e:"")})},EARTH_RADIUS:6378100,_distance:function(e,t,n,s){var r=t-s;return r=r*Math.PI/180,e=e*Math.PI/180,n=n*Math.PI/180,this.EARTH_RADIUS*Math.acos(Math.sin(e)*Math.sin(n)+Math.cos(e)*Math.cos(n)*Math.cos(r))},_updateDegree:function(e){for(e+=180;0>e;)e+=360;return 0==e?180:e%360-180},_countLittleRadius:function(e){var t=Math.abs(e)/180*this.EARTH_RADIUS,n=2*this.EARTH_RADIUS,s=(Math.pow(n,2)-n*Math.sqrt(Math.pow(n,2)-4*Math.pow(t,2)))/2;return n/2-Math.sqrt(s-Math.pow(t,2))},_isDefiniteRect:function(e,t){return null!=e&&null!=t},_getOutRectangle:function(){return 1==arguments.length?this._getOutRectangleNodes(arguments[1]):this._getOutRectangleCircle(arguments[0],arguments[1])},_getOutRectangleCircle:function(e,t){var n,s,r,i,a=this._distance(e.latitude,e.longitude,t.latitude,t.longitude),o=e.latitude+180*a/(Math.PI*this.EARTH_RADIUS)*(e.latitude>0?1:-1),c=this._countLittleRadius(o);return c>a?(n=e.longitude-180*a/c,s=2*e.longitude-n,n=this._updateDegree(n),s=s%360==180?180:this._updateDegree(s)):(n=-180,s=180),e.latitude>0?(r=o,i=2*e.latitude-o):(i=o,r=2*e.latitude-o),[Math.min(r,90),n,Math.max(i,-90),s]},_getOutRectangleNodes:function(e){for(var t=e[0].latitude,n=e[0].longitude,s=e[0].latitude,r=e[0].longitude,i=0,a=0,o=0,c=1;c<e.length;c++){e[c].latitude>t&&(t=e[c].latitude),e[c].latitude<s&&(s=e[c].latitude);var l=e[c].latitude-e[c-1].latitude;0>l&&l>-180||l>270?(l>270&&(l-=360),o+=l,i>o&&(i=o)):(l>0&&180>=l||-270>=l)&&(-270>=l&&(l+=360),o+=l,o>a&&(a=o))}return n+=i,r+=a,r-n>=360?(r=180,n=-180):(r=this._updateDegree(r),n=this._updateDegree(n)),[t,n,s,r]},_getPointPosition:function(e,t,n){var s=n.longitude-t.longitude;if(0>s&&s>-180||s>180){var r=t;t=n,n=r}if(e.latitude<t.latitude==e.latitude<n.latitude)return"NO_INTERSECT";var i=e.longitude-t.longitude;(0>i&&i>-180||i>180)&&(i=(i-360)%360);var a=(n.longitude-t.longitude+360)%360,o=a*(e.latitude-t.latitude)/(n.latitude-t.latitude)-i;return o>0?"INTERSECT":"NO_INTERSECT"},_isPointInRectangular:function(e,t,n){return e.latitude>t.latitude||e.latitude<n.latitude?!1:t.longitude>n.longitude?e.longitude>=t.longitude||e.longitude<=n.longitude:e.longitude>=t.longitude&&e.longitude<=n.longitude},_isPointInCircle:function(e,t,n){return this._distance(e.latitude,e.longitude,t.latitude,t.longitude)<=n},_isPointInShape:function(e,t){function n(e,t){return(e+1)%t.length}for(var s=0,r=0;r<t.length;r++){var i=this._getPointPosition(e,t[r],t[n(r,t)]);switch(i){case"INTERSECT":s++;break;case"ON_LINE":case"NO_INTERSECT":}}return s%2==1},_isPointInFence:function(e,t){return this._isPointInRectangular(e,t.nwPoint,t.sePoint)||"CIRCLE"==t.type&&this._isPointInCircle(e,t.nodes[0],this._distance(t.nodes[0].latitude,t.nodes[0].longitude,t.nodes[1].latitude,t.nodes[1].longitude))||"SHAPE"==t.type&&this._isPointInShape(e,t.nodes)},_typesMapper:{RECT:function(e){e.nwPoint=e.nodes[0],e.sePoint=e.nodes[1]},CIRCLE:function(e,t){var n=t._getOutRectangle(e.nodes[0],e.nodes[1]);e.nwPoint={latitude:n[0],longitude:n[1]},e.sePoint={latitude:n[2],longitude:n[3]}},SHAPE:function(e,t){var n=t._getOutRectangle(e.nodes[0],e.nodes[1]);e.nwPoint={latitude:n[0],longitude:n[1]},e.sePoint={latitude:n[2],longitude:n[3]}}},_maxDuration:5e3,_timers:{},_checkPosition:function(e,t,n,s,r,i,a){for(var o=this,c=0;c<o._trackedFences.length;c++){var l=o._isDefiniteRect(o._trackedFences[c].nwPoint,o._trackedFences[c].sePoint)&&o._isPointInFence(t,o._trackedFences[c]),u=null;if(l!=i[o._trackedFences[c].geofenceName]&&(u=i[o._trackedFences[c].geofenceName]?"onexit":"onenter",i[o._trackedFences[c].geofenceName]=l),u){var d=1e3*o._trackedFences[c].onStayDuration,h=function(e,t,n){var s=function(){r.onstay(o._trackedFences[e].geofenceName,o._trackedFences[e].objectId,t.latitude,t.longitude)};o._timers[o._trackedFences[e].geofenceName]=setTimeout(s,n)},p=function(e,t,n,s){var r=function(){o._runFenceAction("onstay",o._trackedFences[e].geofenceName,s,a)};o._timers[o._trackedFences[e].geofenceName]=setTimeout(r,n)};r?"onenter"==u?(r[u](o._trackedFences[c].geofenceName,o._trackedFences[c].objectId,t.latitude,t.longitude),d>-1?!function(e,t,n){return h(e,t,n)}(c,t,d):r.onstay(o._trackedFences[c].geofenceName,o._trackedFences[c].objectId,t.latitude,t.longitude)):(clearTimeout(o._timers[o._trackedFences[c].geofenceName]),r[u](o._trackedFences[c].geofenceName,o._trackedFences[c].objectId,t.latitude,t.longitude)):s&&(s.latitude=t.latitude,s.longitude=t.longitude,"onenter"==u?(o._runFenceAction(u,o._trackedFences[c].geofenceName,s,a),d>-1?!function(e,t,n,s){return p(e,t,n,s)}(c,t,d,s):o._runFenceAction("onstay",o._trackedFences[c].geofenceName,s,a)):(clearTimeout(o._timers[o._trackedFences[c].geofenceName]),o._runFenceAction(u,o._trackedFences[c].geofenceName,s,a)))}}},_mobilecheck:function(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e},_trackedFences:[],_lastResults:{},_startMonitoring:function(e,t,n){function s(e,t,n){for(var s=e.length,r=!1,i=0;s>i&&!(r=e[i][n]===t[n]);i++);return r}function r(s){o._checkPosition(e,s.coords,l,c?t:null,c?null:t,o._lastResults,n)}function i(e){throw new Error("Error during current position calculation. Error "+e.message)}function a(){navigator.geolocation.getCurrentPosition(r,i,{timeout:5e3,enableHighAccuracy:!0})}var o=this;if(t instanceof GeoPoint)var c=!0;for(var l=this._getFences(e),u=0;u<l.length;u++)s(o._trackedFences,l[u],"geofenceName")||(o._typesMapper[l[u].type](l[u],o),o._lastResults[l[u].geofenceName]=!1,o._trackedFences.push(l[u]));if(!this.monitoringId){if(!l.length)throw new Error("Please, add some fences to start monitoring");this.monitoringId=this._mobilecheck()?navigator.geolocation.watchPosition(r,i,{timeout:o._maxDuration,enableHighAccuracy:!0}):setInterval(a,o._maxDuration)}},startGeofenceMonitoringWithInAppCallback:function(e,t,n){this._startMonitoring(e,t,n)},startGeofenceMonitoringWithRemoteCallback:function(e,t,n){this._startMonitoring(e,t,n)},stopGeofenceMonitoring:function(e){var t=this;if(e)for(var n=0;n<t._trackedFences.length;n++)t._trackedFences[n].geofenceName==e&&(t._trackedFences.splice(n,1),delete t._lastResults[e]);else this._lastResuls={},this._trackedFences=[];t._trackedFences.length||(t.monitoringId=null,t._mobilecheck()?navigator.geolocation.clearWatch(t.monitoringId):clearInterval(t.monitoringId))}},Proxy.prototype={on:function(e,t){if(!e)throw new Error("Event name not specified");if(!t)throw new Error("Handler not specified");this.eventHandlers[e]=this.eventHandlers[e]||[],this.eventHandlers[e].push(t)},fireEvent:function(e,t){var n,s,r=this.eventHandlers[e]||[];for(s=0,n=r.length;n>s;++s)r[s](t)}},PollingProxy.prototype=new Proxy,deepExtend(PollingProxy.prototype,{onMessage:function(e){clearTimeout(this.timeout);var t=this;this.timer=setTimeout(function(){t.poll()},this.interval),this.fireEvent("messageReceived",e)},poll:function(){var e=this;this.timeout=setTimeout(function(){e.onTimeout()},3e4),this.xhr=Backendless._ajax({method:"GET",url:this.restUrl,isAsync:!0,asyncHandler:this.responder})},close:function(){clearTimeout(this.timer),clearTimeout(this.timeout),this.needReconnect=!1,this.xhr&&this.xhr.abort()},onTimeout:function(){this.xhr&&this.xhr.abort()},onError:function(){if(clearTimeout(this.timer),clearTimeout(this.timeout),this.needReconnect){var e=this;this.xhr=null,this.timer=setTimeout(function(){e.poll()},this.interval)}}}),SocketProxy.prototype=new Proxy,deepExtend(SocketProxy.prototype,{onMessage:function(){this.fireEvent("messageReceived",data)},onSocketClose:function(e){this.reconnectWithPolling&&this.fireEvent("socketClose",e)},close:function(){this.reconnectWithPolling=!1,this.socket.close()}}),Subscription.prototype={_subscribe:function(e){var t=extractResponder(arguments),n=null!=t,s=this,r=new Async(function(e){s.subscriptionId=e.subscriptionId,s._startSubscription()},function(e){t.fault(e)}),i=Backendless._ajax({method:"POST",url:this.restUrl+"/subscribe",isAsync:n,data:JSON.stringify(this.options),asyncHandler:r});n||(this.subscriptionId=i.subscriptionId,this._startSubscription())},_startSubscription:function(){var e=this;if(WebSocket){var t=this.channelProperties.websocket+"/"+this.subscriptionId;this.proxy=new SocketProxy(t),this.proxy.on("socketClose",function(){e._switchToPolling()}),this.proxy.on("messageReceived",function(){e.responder()})}else this._switchToPolling();this._startSubscription=emptyFn},cancelSubscription:function(){this.proxy&&this.proxy.close(),this._startSubscription=emptyFn},_switchToPolling:function(){var e=this.restUrl+"/"+this.subscriptionId;this.proxy=new PollingProxy(e);var t=this;this.proxy.on("messageReceived",function(e){e.messages.length&&t.responder(e)})}},Messaging.prototype={_getProperties:function(e,t){var n=extractResponder(arguments),s=null!=n,r=this.channelProperties[e];if(r)return s&&t.success(r),r;var i=Backendless._ajax({method:"GET",url:this.restUrl+"/"+e+"/properties",isAsync:s,asyncHandler:n});return this.channelProperties[e]=i,i},subscribe:function(e,t,n,s){var r=extractResponder(arguments),i=null!=r;if(!i){var a=this._getProperties(e);return new Subscription({channelName:e,options:n,channelProperties:a,responder:t,restUrl:this.restUrl})}var o=this,c=new Async(function(i){s.success(new Subscription({channelName:e,options:n,channelProperties:i,responder:t,restUrl:o.restUrl,onSubscribe:r}))},function(e){r.fault(e)});this._getProperties(e,c)},publish:function(e,t,n,s,r){var i=extractResponder(arguments),a=null!=i,o={message:t};if(n){if(!(n instanceof PublishOptions))throw"Use PublishOption as publishOptions argument";deepExtend(o,n)}if(s){if(!(s instanceof DeliveryOptions))throw"Use DeliveryOptions as deliveryTarget argument";deepExtend(o,s)}return Backendless._ajax({method:"POST",url:this.restUrl+"/"+e,isAsync:a,asyncHandler:i,data:JSON.stringify(o)})},sendEmail:function(e,t,n,s,r){var i=extractResponder(arguments),a=null!=i,o={};if(!e||Utils.isEmpty(e)||!Utils.isString(e))throw"Subject is required parameter and must be a nonempty string";if(o.subject=e,!(t instanceof Bodyparts)||Utils.isEmpty(t))throw"Use Bodyparts as bodyParts argument, must contain at least one property";if(o.bodyparts=t,!n||!Utils.isArray(n)||Utils.isEmpty(n))throw"Recipients is required parameter, must be a nonempty array";if(o.to=n,s){if(!Utils.isArray(s))throw"Attachments must be an array of file IDs from File Service";Utils.isEmpty(s)||(o.attachment=s)}return Backendless._ajax({method:"POST",url:this.restUrl+"/email",isAsync:a,asyncHandler:i,data:JSON.stringify(o)})},cancel:function(e,t){var n=null!=t;return Backendless._ajax({method:"DELETE",url:this.restUrl+"/"+e,isAsync:n,asyncHandler:new Async(emptyFn)})},registerDevice:function(e,t,n){var s=extractResponder(arguments),r=null!=s,i=isBrowser?window.device:NodeDevice,a={deviceToken:null,deviceId:i.uuid,os:i.platform,osVersion:i.version};Utils.isArray(e)&&(a.channels=e);for(var o=0,c=arguments.length;c>o;++o){var l=arguments[o];(Utils.isNumber(l)||l instanceof Date)&&(a.expiration=l instanceof Date?l.getTime()/1e3:l)}var u=this.restUrl+"/registrations",d=function(e){a.deviceToken=e,Backendless._ajax({method:"POST",url:u,data:JSON.stringify(a),isAsync:r,asyncHandler:s})},h=function(e){console.warn(JSON.stringify(["failed to register ",e]))},p={projectid:"http://backendless.com",appid:Backendless.applicationId};cordova.exec(d,h,"PushNotification","registerDevice",[p])},getRegistrations:function(e){var t=isBrowser?window.device.uuid:NodeDevice.uuid,n=extractResponder(arguments),s=null!=n;return Backendless._ajax({method:"GET",url:this.restUrl+"/registrations/"+t,isAsync:s,asyncHandler:n})},unregisterDevice:function(e){var t=isBrowser?window.device.uuid:NodeDevice.uuid,n=extractResponder(arguments),s=null!=n,r=Backendless._ajax({method:"DELETE",url:this.restUrl+"/registrations/"+t,isAsync:s,asyncHandler:n});try{cordova.exec(emptyFn,emptyFn,"PushNotification","unregisterDevice",[])}catch(i){console.log(i.message)}return r}},FilePermissions.prototype={grantUser:function(e,t,n,s){return this.varType="user",this.id=e,this.grant(t,n,s)},grantRole:function(e,t,n,s){return this.varType="role",this.id=e,this.grant(t,n,s)},grant:function(e,t,n){return this.sendRequest("GRANT",e,t,n)},denyUser:function(e,t,n,s){return this.varType="role",this.id=e,this.deny(t,n,s)},denyRole:function(e,t,n,s){return this.varType="role",this.id=e,this.deny(t,n,s)},deny:function(e,t,n){return this.sendRequest("DENY",e,t,n)},sendRequest:function(e,t,n,s){var r=extractResponder(arguments),i=null!=r,a={permission:n};return a[this.varType]=this.id||"*",Backendless._ajax({method:"PUT",url:this.restUrl+"/"+e+"/"+encodeURIComponent(t),data:JSON.stringify(a),isAsync:i,asyncHandler:r})}},Files.prototype={saveFile:function(e,t,n,s,r){if(!e||!Utils.isString(e))throw new Error('Missing value for the "path" argument. The argument must contain a string value');if(!t||!Utils.isString(e))throw new Error('Missing value for the "fileName" argument. The argument must contain a string value');if(s instanceof Backendless.Async&&(r=s,s=null),n instanceof File||(n=new Blob([n])),n.size>28e5)throw new Error("File Content size must be less than 2,800,000 bytes");var i=this.restUrl+"/binary/"+e+(Utils.isString(t)?"/"+t:"")+(s?"?overwrite=true":"");try{var a=new FileReader;if(a.fileName=encodeURIComponent(t).replace(/'/g,"%27").replace(/"/g,"%22"),a.uploadPath=i,a.onloadend=sendEncoded,r&&(a.asyncHandler=r),a.onerror=function(e){r.fault(e)},a.readAsDataURL(n),!r)return!0}catch(o){console.log(o)}},upload:function(e,t,n,s){e=e.files||e;var r=this.restUrl+"/"+t+"/";if(Utils.isBoolean(n))var i="?overwrite="+n;if(!isBrowser)throw"Upload File not supported with NodeJS";if(window.File&&window.FileList){e instanceof File&&(e=[e]);for(var a=0,o=0,c=e.length;c>o;o++)try{var l=new FileReader;l.fileName=encodeURIComponent(e[o].name).replace(/'/g,"%27").replace(/"/g,"%22"),l.uploadPath=r+l.fileName+(i?i:""),l.onloadend=send,l.asyncHandler=s,l.onerror=function(e){s.fault(e)},l.readAsBinaryString(e[o])}catch(u){a++}}else{var d=document.createElement("iframe");d.id=d.name="ifr"+getNow(),d.width=d.height="0",document.body.appendChild(d);var h=document.createElement("form");h.target=d.name,h.enctype="multipart/form-data",h.method="POST",document.body.appendChild(h),h.appendChild(e);var p=encodeURIComponent(e.value).replace(/'/g,"%27").replace(/"/g,"%22"),f=p.lastIndexOf("\\");f&&(p=p.substring(f+1)),h.action=r+p+(i?i:""),h.submit()}},listing:function(e,t,n,s,r,i){var a=extractResponder(arguments),o=null!=a,c=this.restUrl+"/"+e;return arguments.length>1&&!(arguments[1]instanceof Backendless.Async)&&(c+="?"),Utils.isString(t)&&(c+="pattern="+t),Utils.isBoolean(n)&&(c+="&sub="+n),Utils.isNumber(s)&&(c+="&pagesize="+s),Utils.isNumber(r)&&(c+="&offset="+r),Backendless._ajax({method:"GET",url:c,isAsync:o,asyncHandler:a})},renameFile:function(e,t,n){this._checkPath(e);var s={oldPathName:e,newName:t};return this._doAction("rename",s,n)},moveFile:function(e,t,n){this._checkPath(e),this._checkPath(t);var s={sourcePath:e,targetPath:t};return this._doAction("move",s,n)},copyFile:function(e,t,n){this._checkPath(e),this._checkPath(t);var s={sourcePath:e,targetPath:t};return this._doAction("copy",s,n)},_checkPath:function(e){return/^\//.test(e)||(e="/"+e),e},_doAction:function(e,t,n){var s=extractResponder(arguments),r=null!=s,i=Backendless._ajax({method:"PUT",url:this.restUrl+"/"+e,data:JSON.stringify(t),isAsync:r,asyncHandler:s});return r?void 0:i},remove:function(e,t){var n=extractResponder(arguments),s=null!=n,r=0==e.indexOf("http://")||0==e.indexOf("https://")?e:this.restUrl+"/"+e;Backendless._ajax({method:"DELETE",url:r,isAsync:s,asyncHandler:n})},exists:function(e,t){if(!e||!Utils.isString(e))throw new Error('Missing value for the "path" argument. The argument must contain a string value');var n=extractResponder(arguments),s=null!=n,r=this.restUrl+"/exists/"+e;return Backendless._ajax({method:"GET",url:r,isAsync:s,asyncHandler:n})},removeDirectory:function(e,t){var n=extractResponder(arguments),s=null!=n;Backendless._ajax({method:"DELETE",url:this.restUrl+"/"+e,isAsync:s,asyncHandler:n})}},Commerce.prototype._wrapAsync=function(e){var t=function(t){e.success(t)},n=function(t){e.fault(t)};return new Async(t,n)},Commerce.prototype.validatePlayPurchase=function(e,t,n,s){if(arguments.length<3)throw new Error("Package Name, Product Id, Token must be provided and must be not an empty STRING!");for(var r=arguments.length-2;r>=0;r--)if(!arguments[r]||!Utils.isString(arguments[r]))throw new Error("Package Name, Product Id, Token must be provided and must be not an empty STRING!");var i=extractResponder(arguments),a=null!=i;return i&&(i=this._wrapAsync(i)),Backendless._ajax({method:"GET",url:this.restUrl+"/validate/"+e+"/inapp/"+t+"/purchases/"+n,isAsync:a,asyncHandler:i})},Commerce.prototype.cancelPlaySubscription=function(e,t,n,s){if(arguments.length<3)throw new Error("Package Name, Subscription Id, Token must be provided and must be not an empty STRING!");for(var r=arguments.length-2;r>=0;r--)if(!arguments[r]||!Utils.isString(arguments[r]))throw new Error("Package Name, Subscription Id, Token must be provided and must be not an empty STRING!");var i=extractResponder(arguments),a=null!=i;return i&&(i=this._wrapAsync(i)),Backendless._ajax({method:"POST",url:this.restUrl+"/"+e+"/subscription/"+t+"/purchases/"+n+"/cancel",isAsync:a,asyncHandler:i})},Commerce.prototype.getPlaySubscriptionStatus=function(e,t,n,s){if(arguments.length<3)throw new Error("Package Name, Subscription Id, Token must be provided and must be not an empty STRING!");for(var r=arguments.length-2;r>=0;r--)if(!arguments[r]||!Utils.isString(arguments[r]))throw new Error("Package Name, Subscription Id, Token must be provided and must be not an empty STRING!");var i=extractResponder(arguments),a=null!=i;return i&&(i=this._wrapAsync(i)),Backendless._ajax({method:"GET",url:this.restUrl+"/"+e+"/subscription/"+t+"/purchases/"+n,isAsync:a,asyncHandler:i})},Events.prototype._wrapAsync=function(e){var t=function(t){e.success(t)},n=function(t){e.fault(t)};return new Async(t,n)},Events.prototype.dispatch=function(e,t,n){if(!e||!Utils.isString(e))throw new Error("Event Name must be provided and must be not an empty STRING!");t=Utils.isObject(t)?t:{};var s=extractResponder(arguments),r=null!=s;return s&&(s=this._wrapAsync(s)),t=t instanceof Backendless.Async?{}:t,Backendless._ajax({method:"POST",url:this.restUrl+"/"+e,data:JSON.stringify(t),isAsync:r,asyncHandler:s})};var Cache=function(){},FactoryMethods=[];Cache.prototype={_wrapAsync:function(e){var t=this,n=function(n){n=t._parseResponse(n),e.success(n)},s=function(t){e.fault(t)};return new Async(n,s)},_parseResponse:function(e){return e},put:function(e,t,n,s){if(!Utils.isString(e))throw new Error("You can use only String as key to put into Cache");if(n instanceof Backendless.Async)s=n,n=null;else if("object"!=typeof n||arguments[3]){if("number"!=typeof n&&void 0!==n)throw new Error("You can use only String as timeToLive attribute to put into Cache")}else s=n,n=null;Utils.isObject(t)&&t.constructor!==Object&&(t.___class=t.___class||getClassName.call(t));var r=extractResponder([s]),i=!1;return null!=r&&(i=!0,r=this._wrapAsync(r)),Backendless._ajax({method:"PUT",url:Backendless.serverURL+"/"+Backendless.appVersion+"/cache/"+e+(n?"?timeout="+n:""),
data:JSON.stringify(t),isAsync:i,asyncHandler:r})},expireIn:function(e,t,n){if(Utils.isString(e)&&(Utils.isNumber(t)||Utils.isDate(t))&&t){t=Utils.isDate(t)?t.getTime():t;var s=extractResponder(arguments),r=!1;return null!=s&&(r=!0,s=this._wrapAsync(s)),Backendless._ajax({method:"PUT",url:Backendless.serverURL+"/"+Backendless.appVersion+"/cache/"+e+"/expireIn?timeout="+t,data:JSON.stringify({}),isAsync:r,asyncHandler:s})}throw new Error('The "key" argument must be String. The "seconds" argument can be either Number or Date')},expireAt:function(e,t,n){if(Utils.isString(e)&&(Utils.isNumber(t)||Utils.isDate(t))&&t){t=Utils.isDate(t)?t.getTime():t;var s=extractResponder(arguments),r=!1;return null!=s&&(r=!0,s=this._wrapAsync(s)),Backendless._ajax({method:"PUT",url:Backendless.serverURL+"/"+Backendless.appVersion+"/cache/"+e+"/expireAt?timestamp="+t,data:JSON.stringify({}),isAsync:r,asyncHandler:s})}throw new Error("You can use only String as key while expire in Cache. Second attribute must be declared and must be a Number or Date type")},cacheMethod:function(e,t,n,s){if(!Utils.isString(t))throw new Error('The "key" argument must be String');var r=extractResponder(arguments),i=!1;return null!=r&&(i=!0,r=this._wrapAsync(r)),Backendless._ajax({method:e,url:Backendless.serverURL+"/"+Backendless.appVersion+"/cache/"+t+(n?"/check":""),isAsync:i,asyncHandler:r})},contains:function(e,t){return this.cacheMethod("GET",e,!0,t)},get:function(key,async){if(!Utils.isString(key))throw new Error('The "key" argument must be String');var responder=extractResponder(arguments),isAsync=!1;null!=responder&&(isAsync=!0,responder=this._wrapAsync(responder));var result=Backendless._ajax({method:"GET",url:Backendless.serverURL+"/"+Backendless.appVersion+"/cache/"+key,isAsync:isAsync,asyncHandler:responder});if(Utils.isObject(result)){if(result.___class){var object;try{var Object=eval(result.___class);object=new Object(result)}catch(e){object=new FactoryMethods[result.___class](result)}return object}return result}return result},remove:function(e,t){return this.cacheMethod("DELETE",e,!1,t)},setObjectFactory:function(e,t){FactoryMethods[e]=t}};var Counters=function(){},AtomicInstance=function(e){this.name=e};Counters.prototype={_wrapAsync:function(e){var t=this,n=function(n){n=t._parseResponse(n),e.success(n)},s=function(t){e.fault(t)};return new Async(n,s)},_parseResponse:function(e){return e},of:function(e){return new AtomicInstance(e)},getConstructor:function(){return this},counterNameValidation:function(e){if(!e)throw new Error('Missing value for the "counterName" argument. The argument must contain a string value.');if(!Utils.isString(e))throw new Error('Invalid value for the "value" argument. The argument must contain only string values');this.name=e},implementMethod:function(e,t,n){var s=extractResponder(arguments),r=!1;return null!=s&&(r=!0,s=this._wrapAsync(s)),Backendless._ajax({method:e,url:Backendless.serverURL+"/"+Backendless.appVersion+"/counters/"+this.name+t,isAsync:r,asyncHandler:s})},incrementAndGet:function(e,t){return this.counterNameValidation(e,t),this.implementMethod("PUT","/increment/get",t)},getAndIncrement:function(e,t){return this.counterNameValidation(e,t),this.implementMethod("PUT","/get/increment",t)},decrementAndGet:function(e,t){return this.counterNameValidation(e,t),this.implementMethod("PUT","/decrement/get",t)},getAndDecrement:function(e,t){return this.counterNameValidation(e,t),this.implementMethod("PUT","/get/decrement",t)},reset:function(e,t){return this.counterNameValidation(e,t),this.implementMethod("PUT","/reset",t)},get:function(e,t){this.counterNameValidation(e,t);var n=extractResponder(arguments),s=!1;return null!=n&&(s=!0,n=this._wrapAsync(n)),Backendless._ajax({method:"GET",url:Backendless.serverURL+"/"+Backendless.appVersion+"/counters/"+this.name,isAsync:s,asyncHandler:n})},implementMethodWithValue:function(e,t,n){if(!t)throw new Error('Missing value for the "value" argument. The argument must contain a numeric value.');if(!Utils.isNumber(t))throw new Error('Invalid value for the "value" argument. The argument must contain only numeric values');var s=extractResponder(arguments),r=!1;return null!=s&&(r=!0,s=this._wrapAsync(s)),Backendless._ajax({method:"PUT",url:Backendless.serverURL+"/"+Backendless.appVersion+"/counters/"+this.name+e+(t?t:""),isAsync:r,asyncHandler:s})},addAndGet:function(e,t,n){return this.counterNameValidation(e,n),this.implementMethodWithValue("/get/incrementby?value=",t,n)},getAndAdd:function(e,t,n){return this.counterNameValidation(e,n),this.implementMethodWithValue("/incrementby/get?value=",t,n)},compareAndSet:function(e,t,n,s){if(this.counterNameValidation(e,s),!t||!n)throw new Error('Missing values for the "expected" and/or "updated" arguments. The arguments must contain numeric values');if(!Utils.isNumber(t)||!Utils.isNumber(n))throw new Error('Missing value for the "expected" and/or "updated" arguments. The arguments must contain a numeric value');var r=extractResponder(arguments),i=!1;return null!=r&&(i=!0,r=this._wrapAsync(r)),Backendless._ajax({method:"PUT",url:Backendless.serverURL+"/"+Backendless.appVersion+"/counters/"+this.name+"/get/compareandset?expected="+(t&&n?t+"&updatedvalue="+n:""),isAsync:i,asyncHandler:r})}},AtomicInstance.prototype={incrementAndGet:function(e){return Counters.prototype.getConstructor().incrementAndGet(this.name,e)},getAndIncrement:function(e){return Counters.prototype.getConstructor().getAndIncrement(this.name,e)},decrementAndGet:function(e){return Counters.prototype.getConstructor().decrementAndGet(this.name,e)},getAndDecrement:function(e){return Counters.prototype.getConstructor().getAndDecrement(this.name,e)},reset:function(e){return Counters.prototype.getConstructor().reset(this.name,e)},get:function(e){return Counters.prototype.getConstructor().get(this.name,e)},addAndGet:function(e,t){return Counters.prototype.getConstructor().addAndGet(this.name,e,t)},getAndAdd:function(e,t){return Counters.prototype.getConstructor().getAndAdd(this.name,e,t)},compareAndSet:function(e,t,n){return Counters.prototype.getConstructor().getAndAdd(this.name,e,t,n)}},Backendless.Logging={restUrl:root.url,loggers:{},logInfo:[],messagesCount:0,numOfMessages:10,timeFrequency:1,getLogger:function(e){if(!Utils.isString(e))throw new Error("Invalid 'loggerName' value. LoggerName must be a string value");return this.loggers[e]||(this.loggers[e]=new Logging(e)),this.loggers[e]},flush:function(){Backendless._ajax({method:"PUT",url:Backendless.serverURL+"/"+Backendless.appVersion+"/log",data:JSON.stringify(this.logInfo)}),this.flushInterval&&clearTimeout(this.flushInterval),this.logInfo=[],this.messagesCount=0},sendRequest:function(){function e(e,n){function s(){Backendless._ajax({method:"PUT",url:Backendless.serverURL+"/"+Backendless.appVersion+"/log",data:JSON.stringify(e),isAsync:!isBrowser}),t.messagesCount=0}t.flushInterval=setTimeout(s,1e3*n)}var t=this;e(this.logInfo,this.timeFrequency),this.logInfo=[]},checkMessagesLen:function(){this.messagesCount>this.numOfMessages-1&&this.sendRequest()},setLogReportingPolicy:function(e,t){this.numOfMessages=e,this.timeFrequency=t,this.checkMessagesLen()}},Logging.prototype={debug:function(e){return setLogMessage(this.name,"DEBUG",e)},info:function(e){return setLogMessage(this.name,"INFO",e)},warn:function(e,t){return setLogMessage(this.name,"WARN",e,t)},error:function(e,t){return setLogMessage(this.name,"ERROR",e,t)},fatal:function(e,t){return setLogMessage(this.name,"FATAL",e,t)},trace:function(e){return setLogMessage(this.name,"TRACE",e)}},CustomServices.prototype={invoke:function(e,t,n,s,r){var i=extractResponder(arguments),a=null!=i;return Backendless._ajax({method:"POST",url:Backendless.serverURL+"/"+Backendless.appVersion+"/services/"+e+"/"+t+"/"+n,data:JSON.stringify(s),isAsync:a,asyncHandler:i})}},Backendless.initApp=function(e,t,n){Backendless.applicationId=e,Backendless.secretKey=t,Backendless.appVersion=n,Backendless.appPath=[Backendless.serverURL,Backendless.appVersion].join("/"),Backendless.UserService=new UserService,Backendless.Users=Backendless.UserService,Backendless.Geo=new Geo,Backendless.Persistence=persistence,Backendless.Data=persistence,Backendless.Data.Permissions=new DataPermissions,Backendless.Messaging=new Messaging,Backendless.Files=new Files,Backendless.Files.Permissions=new FilePermissions,Backendless.Commerce=new Commerce,Backendless.Events=new Events,Backendless.Cache=new Cache,Backendless.Counters=new Counters,Backendless.CustomServices=new CustomServices,dataStoreCache={},currentUser=null},"function"==typeof define&&define.amd?define("backendless",[],function(){return Backendless}):"undefined"!=typeof module&&module.exports&&(module.exports=Backendless)}(this);var BackendlessGeoQuery=function(){this.searchRectangle=void 0,this.categories=[],this.includeMetadata=!0,this.metadata=void 0,this.condition=void 0,this.relativeFindMetadata=void 0,this.relativeFindPercentThreshold=void 0,this.pageSize=void 0,this.latitude=void 0,this.longitude=void 0,this.radius=void 0,this.units=void 0,this.degreePerPixel=void 0,this.clusterGridSize=void 0};BackendlessGeoQuery.prototype={addCategory:function(){this.categories=this.categories||[],this.categories.push()},setClusteringParams:function(e,t,n,s){s=s||0;var r=parseFloat(e),i=parseFloat(t),a=parseInt(n),o=parseInt(s);if(!isFinite(r)||-180>r||r>180)throw new Error("The westLongitude value must be a number in the range between -180 and 180");if(!isFinite(i)||-180>i||i>180)throw new Error("The eastLongitude value must be a number in the range between -180 and 180");if(!isFinite(a)||1>a)throw new Error("The mapWidth value must be a number greater or equal to 1");if(!isFinite(o)||0>o)throw new Error("The clusterGridSize value must be a number greater or equal to 0");var c=i-r;0>c&&(c+=360),this.degreePerPixel=c/a,this.clusterGridSize=o||null}};var GeoPoint=function(){this.___class="GeoPoint",this.categories=void 0,this.latitude=void 0,this.longitude=void 0,this.metadata=void 0,this.objectId=void 0},GeoCluster=function(){this.categories=void 0,this.latitude=void 0,this.longitude=void 0,this.metadata=void 0,this.objectId=void 0,this.totalPoints=void 0,this.geoQuery=void 0},PublishOptionsHeaders={MESSAGE_TAG:"message",IOS_ALERT_TAG:"ios-alert",IOS_BADGE_TAG:"ios-badge",IOS_SOUND_TAG:"ios-sound",ANDROID_TICKER_TEXT_TAG:"android-ticker-text",ANDROID_CONTENT_TITLE_TAG:"android-content-title",ANDROID_CONTENT_TEXT_TAG:"android-content-text",ANDROID_ACTION_TAG:"android-action",WP_TYPE_TAG:"wp-type",WP_TITLE_TAG:"wp-title",WP_TOAST_SUBTITLE_TAG:"wp-subtitle",WP_TOAST_PARAMETER_TAG:"wp-parameter",WP_TILE_BACKGROUND_IMAGE:"wp-backgroundImage",WP_TILE_COUNT:"wp-count",WP_TILE_BACK_TITLE:"wp-backTitle",WP_TILE_BACK_BACKGROUND_IMAGE:"wp-backImage",WP_TILE_BACK_CONTENT:"wp-backContent",WP_RAW_DATA:"wp-raw"},PublishOptions=function(e){e=e||{},this.publisherId=e.publisherId||void 0,this.headers=e.headers||void 0,this.subtopic=e.subtopic||void 0},DeliveryOptions=function(e){e=e||{},this.pushPolicy=e.pushPolicy||void 0,this.pushBroadcast=e.pushBroadcast||void 0,this.pushSinglecast=e.pushSinglecast||void 0,this.publishAt=e.publishAt||void 0,this.repeatEvery=e.repeatEvery||void 0,this.repeatExpiresAt=e.repeatExpiresAt||void 0},Bodyparts=function(e){e=e||{},this.textmessage=e.textmessage||void 0,this.htmlmessage=e.htmlmessage||void 0},SubscriptionOptions=function(e){e=e||{},this.subscriberId=e.subscriberId||void 0,this.subtopic=e.subtopic||void 0,this.selector=e.selector||void 0};